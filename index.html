<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>iComprova GitHub</title>
</head>
<body style="background:#111;color:#fff;font-family:Arial;padding:30px">

<h2>Enviar MDF-e (GitHub Only)</h2>

<textarea id="xml" style="width:100%;height:200px"></textarea><br>
<button onclick="enviar()">Enviar</button>

<pre id="out"></pre>

<script>
async function enviar(){
  const xml = document.getElementById("xml").value;

  await fetch(
    "https://api.github.com/repos/SEU_USUARIO/SEU_REPO/dispatches",
    {
      method: "POST",
      headers: {
        "Authorization": "token SEU_GITHUB_TOKEN",
        "Accept": "application/vnd.github+json"
      },
      body: JSON.stringify({
        event_type: "workflow_dispatch",
        client_payload: {}
      })
    }
  );

  document.getElementById("out").textContent =
    "Enviado. Aguarde ~20s e atualize para ver o resultado.";
}

async function ler(){
  const r = await fetch("responses/result.json?"+Date.now());
  document.getElementById("out").textContent = await r.text();
}

setInterval(ler, 5000);
</script>

</body>
</html>
